<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pokemon Stats</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: #f4f7f9;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            color: #333;
        }

        .stat-container {
            background-color: #ffffff;
            padding: 1.25rem 2rem 1.25rem 2rem;
            border-radius: 12px;
            box-shadow: 0 1px 200px rgba(0, 0, 0, 0.08);
            width: 90%;
            max-width: 650px;
            display: flex;
            flex-direction: column;
            gap: 1.75rem; 
        }

        .stat-bar {
            display: grid;
            /* Label | Text Box | Slider */
            grid-template-columns: 140px 60px 1fr;
            gap: 1rem;
            align-items: center;
        }

        .stat-label {
            font-weight: 600;
            text-align: right;
            font-size: 1rem;
        }

        .stat-value {
            width: 50px;
            padding: 8px;
            text-align: center;
            border: 1px solid #dcdcdc;
            border-radius: 6px;
            font-size: 1rem;
            font-weight: 500;
        }

        .stat-value::-webkit-outer-spin-button,
        .stat-value::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }


        input[type=range] {
            -webkit-appearance: none;
            appearance: none;
            width: 100%;
            height: 12px;
            border-radius: 6px;
            outline: none;
            padding: 0;
            margin: 0;
            border: 1px solid #ddd;
            background: linear-gradient(to right, var(--bar-color) 0%, var(--bar-color) var(--fill-percent), #ffffff var(--fill-percent), #ffffff 100%);
        }

        /* makes the slider button invisible */
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 0px;
            height: 0px;
        }

        /* color ranks taken from pokemondb.net */
        .barchart-rank-1 { --bar-color: #f34444; }
        .barchart-rank-2 { --bar-color: #ff7f0f; }
        .barchart-rank-3 { --bar-color: #ffdd57; }
        .barchart-rank-4 { --bar-color: #a0e515; }
        .barchart-rank-5 { --bar-color: #23cd5e; }
        .barchart-rank-6 { --bar-color: #00c2b8; }
    </style>
</head>
<body>

    <div style="position: absolute; top: 30px; width: 100%; display: flex; justify-content: center;">
        <input type="text" id="character-name" placeholder="Enter PokÃ©mon Name" style="
            border: 1px solid #dcdcdc;
            border-radius: 12px;
            font-size: 1.5rem;
            padding: 0.5rem 0rem 0.5rem 0rem;
            text-align: center;
            width: 60%;
            max-width: 400px;
            background-color: solid;
            outline: none;
            color: #333;
            font-weight: 600;
            caret-color: transparent;
        " onfocus="this.style.caretColor='auto'" onblur="this.style.caretColor='transparent'">
    </div>


    <div class="stat-container" id="stat-container">
        </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const statContainer = document.getElementById('stat-container');
            
            const stats = [
                { name: 'HP', value: 30 },
                { name: 'Attack', value: 60 },
                { name: 'Defense', value: 90 },
                { name: 'Special Attack', value: 120 },
                { name: 'Special Defense', value: 150 },
                { name: 'Speed', value: 255 }
            ];

            const rankClasses = [
                'barchart-rank-1', 'barchart-rank-2', 'barchart-rank-3',
                'barchart-rank-4', 'barchart-rank-5', 'barchart-rank-6'
            ];

            // the color ranks go up to 180, nice even number for 6 stats right
            const COLOR_MAX_VALUE = 180;
            const RANK_INTERVAL = COLOR_MAX_VALUE / 6;

            /**
             * @param {number} value 
             * @returns {string}
             */
            const getRankClass = (value) => {
                if (value <= RANK_INTERVAL * 1) return rankClasses[0]; // <= 30
                if (value <= RANK_INTERVAL * 2) return rankClasses[1]; // <= 60
                if (value <= RANK_INTERVAL * 3) return rankClasses[2]; // <= 90
                if (value <= RANK_INTERVAL * 4) return rankClasses[3]; // <= 120
                if (value <= RANK_INTERVAL * 5) return rankClasses[4]; // <= 150
                return rankClasses[5]; // > 150
            };

            /**
             * @param {HTMLInputElement} slider
             * @param {HTMLInputElement} valueInput 
             * @param {number} value 
             */
            const updateStatDisplay = (slider, valueInput, value) => {
                const clampedValue = Math.max(0, Math.min(255, value));

                slider.value = clampedValue;
                if (document.activeElement !== valueInput) {
                    valueInput.value = clampedValue;
                }

                const newRankClass = getRankClass(clampedValue);
                slider.className = ''; 
                slider.classList.add(newRankClass);

                const fillPercent = (clampedValue / 255) * 100;

                slider.style.setProperty('--fill-percent', `${fillPercent}%`);
            };

            stats.forEach(stat => {
                const statBar = document.createElement('div');
                statBar.className = 'stat-bar';

                const label = document.createElement('label');
                label.className = 'stat-label';
                label.textContent = stat.name;
                label.htmlFor = `stat-slider-${stat.name}`;

                const valueInput = document.createElement('input');
                valueInput.type = 'number';
                valueInput.className = 'stat-value';
                valueInput.min = 0;
                valueInput.max = 255;
                valueInput.value = stat.value;
                valueInput.id = `stat-value-${stat.name}`;

                const slider = document.createElement('input');
                slider.type = 'range';
                slider.min = 0;
                slider.max = 255;
                slider.value = stat.value;
                slider.id = `stat-slider-${stat.name}`;

                statBar.append(label, valueInput, slider);
                statContainer.appendChild(statBar);

                
                // when the slider is moved, update everything
                slider.addEventListener('input', () => {
                    updateStatDisplay(slider, valueInput, parseInt(slider.value, 10));
                    updateBST();
                });


                // When the text box value is changed, update everything
                valueInput.addEventListener('input', () => {
                    updateStatDisplay(slider, valueInput, parseInt(valueInput.value, 10) || 0);
                    updateBST();
                });
                
                updateStatDisplay(slider, valueInput, stat.value);
            });
            
            // BST bar
            const bstBar = document.createElement('div');
            bstBar.className = 'stat-bar';

            const bstLabel = document.createElement('label');
            bstLabel.className = 'stat-label';
            bstLabel.textContent = 'BST';

            const bstValue = document.createElement('input');
            bstValue.type = 'number';
            bstValue.className = 'stat-value';
            bstValue.readOnly = true;
            bstValue.value = 0;
            bstValue.style.backgroundColor = '#f9fafb';
            bstValue.style.fontWeight = '700';
            bstValue.style.border = 'none';

            const emptySpan = document.createElement('span');

            bstBar.append(bstLabel, bstValue, emptySpan);
            statContainer.appendChild(bstBar);

            const updateBST = () => {
                const total = stats.reduce((sum, stat) => {
                    const input = document.getElementById(`stat-value-${stat.name}`);
                    return sum + (parseInt(input.value, 10) || 0);
                }, 0);
                bstValue.value = total;
            };

            updateBST();

        });
    </script>

</body>
</html>
